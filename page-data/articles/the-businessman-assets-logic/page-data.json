{"componentChunkName":"component---src-components-article-tsx-content-file-path-home-runner-work-sergii-dev-sergii-dev-articles-2024-02-25-the-businessman-assets-logic-mdx","path":"/articles/the-businessman-assets-logic/","result":{"data":{"site":{"siteMetadata":{"title":"Sergii Mykhailov","author":"Sergii Mykhailov"}},"mdx":{"excerpt":"With the exchange logic and the market logic being implemented, we can move to the next part of the game - Assets. Our work will be toâ€¦","body":"\nWith the [exchange logic](/articles/the-businessman-exchange-logic) and the [market logic](/articles/the-businessman-market-logic) being implemented, we can move to the next part of the game - **Assets**.\nOur work will be to implement the logic for selling cars, houses, lands and oils. And it will be so easy to do, as effectively we are going to reverse the exchange logic and sell goods instead of buying them.\n\n## UI changes\n\nWe just add the input fields and error messge, the same as we've done in the market logic.\n\n```html {numberLines: 421}\n<div id=\"sell-land\" class=\"hidden text-smaller text-color-turquoise\">\n  <div>\n    <label for=\"amount-land-sell\">\n      How much land do you want to sell:\n      <input\n        id=\"amount-land-sell\"\n        title=\"Amount of land to sell\"\n        type=\"number\"\n        min=\"1\"\n        class=\"text-color-turquoise\"\n      />\n    </label>\n  </div>\n</div>\n<div id=\"sell-oil\" class=\"hidden text-smaller text-color-turquoise\">\n  <div>\n    <label for=\"amount-oil-sell\">\n      How much oil do you want to sell:\n      <input\n        id=\"amount-oil-sell\"\n        title=\"Amount of oil to sell\"\n        type=\"number\"\n        min=\"1\"\n        class=\"text-color-turquoise\"\n      />\n    </label>\n  </div>\n</div>\n<p id=\"assets-error\" class=\"text-smaller text-color-red\"></p>\n```\n\n## Handling assets selling logic\n\nThe logic to sell goods is similar to the one which we used in the exchange logic.\nBased on \"c\" or \"h\" key press, we will automatically sell the car or house.\nWith \"l\" and \"o\" key press, we will sell the land and oil. But this logic will require to enter amount of goods to be sold.\nFor that \"Enter\" or \"Tab\" key press will process the selling.\n\n{/* prettier-ignore-start */}\n```js {numberLines: 750}\nconst assignAssetsWindowActions = () => {\n    let sellLandProcessing = false;\n    let sellOilProcessing = false;\n\n    document.addEventListener('keydown', (e) => {\n        const assetsWindow = document.getElementById('assets-main');\n        if (assetsWindow.classList.contains('hidden')) {\n            return;\n        }\n\n        const sellHouseKeyBinding = 'h';\n        const sellCarKeyBinding = 'c';\n        const sellLandKeyBinding = 'l';\n        const sellOilKeyBinding = 'o';\n\n        const assetsError = document.getElementById('assets-error');\n        const sellLand = document.getElementById('sell-land');\n        const sellOil = document.getElementById('sell-oil');\n\n        const amountLandToSell = document.getElementById('amount-land-sell');\n        const amountOilToSell = document.getElementById('amount-oil-sell');\n\n        assetsError.innerText = '';\n\n        const cleanPrompts = () => {\n            sellLand.classList.add('hidden');\n            sellOil.classList.add('hidden');\n\n            amountLandToSell.value = '';\n            amountOilToSell.value = '';\n\n            assetsError.innerText = '';\n\n            sellLandProcessing = false;\n            sellOilProcessing = false;\n        };\n\n        if (e.key === sellHouseKeyBinding || (e.key === sellHouseKeyBinding.toUpperCase() && e.shiftKey)) {\n            gameData.accountBalances.accountBalance += gameData.assets.house.price;\n            gameData.assets.house = undefined;\n\n            setAssets(gameData.assets);\n            setAccountsBalance(gameData.accountBalances);\n            document.getElementById('assets-main').classList.add('hidden');\n            return\n        }\n\n        if (e.key === sellCarKeyBinding || (e.key === sellCarKeyBinding.toUpperCase() && e.shiftKey)) {\n            gameData.accountBalances.accountBalance += gameData.assets.car.price;\n            gameData.assets.car = undefined;\n\n            setAssets(gameData.assets);\n            setAccountsBalance(gameData.accountBalances);\n            document.getElementById('assets-main').classList.add('hidden');\n            return\n        }\n\n        if (e.key === sellLandKeyBinding || (e.key === sellLandKeyBinding.toUpperCase() && e.shiftKey)) {\n            if (sellOilProcessing) {\n                return;\n            }\n\n            sellLand.classList.remove('hidden');\n            amountLandToSell.focus();\n\n            sellLandProcessing = true;\n        }\n\n        if (e.key === sellOilKeyBinding || (e.key === sellOilKeyBinding.toUpperCase() && e.shiftKey)) {\n            if (sellLandProcessing) {\n                return;\n            }\n\n            sellOil.classList.remove('hidden');\n            amountOilToSell.focus();\n\n            sellOilProcessing = true;\n        }\n\n        if (e.key === 'Enter' || e.key === 'Tab') {\n            if (sellLandProcessing) {\n                const amountValue = +amountLandToSell.value;\n                const totalLandPrice = amountValue * gameData.currentMonthExchangePrices.land;\n\n                if (amountValue > gameData.assets.land.amount) {\n                    amountLandToSell.value = '';\n                    assetsError.innerText = 'You do not have that much land.';\n                    return;\n                }\n\n                if (amountValue > 0) {\n                    gameData.assets.land.amount -= amountValue;\n                    gameData.accountBalances.accountBalance += totalLandPrice;\n                } else {\n                    return;\n                }\n            }\n\n            if (sellOilProcessing) {\n                const amountValue = +amountOilToSell.value;\n                const totalOilPrice = amountValue * gameData.currentMonthExchangePrices.oil;\n\n                if (amountValue > gameData.assets.oil.amount) {\n                    amountOilToSell.value = '';\n                    assetsError.innerText = 'You do not have that much oil.';\n                    return;\n                }\n\n                if (amountValue > 0) {\n                    gameData.assets.oil.amount -= amountValue;\n                    gameData.accountBalances.accountBalance += totalOilPrice;\n                } else {\n                    return;\n                }\n            }\n\n            setAccountsBalance(gameData.accountBalances);\n\n            cleanPrompts();\n            document.getElementById('assets-main').classList.add('hidden');\n        }\n\n        if (e.key === 'Escape') {\n            cleanPrompts();\n        }\n    }, true);\n}\n```\n{/* prettier-ignore-end */}\n\nAlso we shouldn't forget to call the `assignAssetsWindowActions` function in the `assignActionHandlers` function.\n\n{/* prettier-ignore-start */}\n```js {numberLines: 878, diff}\nconst assignActionHandlers = () => {\n  assignBankWindowActions();\n  assignMarketWindowActions();\n  assignExchangeWindowActions();\n+   assignAssetsWindowActions();\n};\n```\n{/* prettier-ignore-end */}\n\nThere is one small change in the `setAssets` function. We need to handle properly the situation, when there is no car or house (when they are sold).\nBut you can check the comparison with the previous version on [GitHub](https://github.com/smykhailov/the-businessman/compare/v0.14...v0.15).\n\n## Summary\n\nThe sources of the changes, as usual, you can find on [GiHub](https://github.com/smykhailov/the-businessman/releases/tag/v0.15).\n\nIn the next article, we will implement the logic part of the UI logic - **Assistant winow**. The logic there will be a little bit more complicated, as we need to display the data from different parts: assets, accounts, market and exchange.\n","frontmatter":{"title":"The Businessman - Assets Logic","date":"2024-02-25T13:21:21.000Z","tags":["businessman","project","javascript"],"keywords":["business logic","javascript","the game","assets logic","assets","sell car","sell house","sell land","sell car"],"featuredImage":{"childImageSharp":{"gatsbyImageData":{"layout":"constrained","backgroundColor":"#0808f8","images":{"fallback":{"src":"/static/9c95bf3ba18b26f2094ddd50706f2ce9/a3024/cover.png","srcSet":"/static/9c95bf3ba18b26f2094ddd50706f2ce9/82a03/cover.png 150w,\n/static/9c95bf3ba18b26f2094ddd50706f2ce9/f7030/cover.png 300w,\n/static/9c95bf3ba18b26f2094ddd50706f2ce9/a3024/cover.png 600w","sizes":"(min-width: 600px) 600px, 100vw"},"sources":[{"srcSet":"/static/9c95bf3ba18b26f2094ddd50706f2ce9/6689f/cover.webp 150w,\n/static/9c95bf3ba18b26f2094ddd50706f2ce9/9598b/cover.webp 300w,\n/static/9c95bf3ba18b26f2094ddd50706f2ce9/3c79e/cover.webp 600w","type":"image/webp","sizes":"(min-width: 600px) 600px, 100vw"}]},"width":600,"height":336}}}},"internal":{"contentFilePath":"/home/runner/work/sergii-dev/sergii-dev/articles/2024-02-25-the-businessman-assets-logic.mdx"},"fields":{"slug":"/articles/the-businessman-assets-logic/","readingTime":{"text":"4 min read","minutes":3.325,"time":199500}}}},"pageContext":{"id":"6f58c9f8-2656-57e2-8793-25939a576d90","frontmatter":{"title":"The Businessman - Assets Logic","date":"2024-02-25T13:21:21.000Z","published":true,"featuredImage":"./images/2024-02-25-the-businessman-assets-logic/cover.png","categories":["Businessman"],"tags":["businessman","project","javascript"],"keywords":["business logic","javascript","the game","assets logic","assets","sell car","sell house","sell land","sell car"]}}},"staticQueryHashes":["1739528850","3446427935"],"slicesMap":{}}