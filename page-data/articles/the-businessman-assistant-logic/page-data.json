{"componentChunkName":"component---src-components-article-tsx-content-file-path-home-runner-work-sergii-dev-sergii-dev-articles-2024-03-20-the-businessman-assistant-logic-mdx","path":"/articles/the-businessman-assistant-logic/","result":{"data":{"site":{"siteMetadata":{"title":"Sergii Mykhailov","author":"Sergii Mykhailov"}},"mdx":{"excerpt":"The assistnat logic is both simple and complex. It is simple because we have a lot of the logic already in place. It is complex because weâ€¦","body":"\nThe assistnat logic is both simple and complex. It is simple because we have a lot of the logic already in place. It is complex because we need to make sure that the assistant is able to handle all the different scenarios that the player can throw at it.\n\nThe Assistant handles different activities that the player can do:\n\n- Buy and sell goods and that has to be tracked.\n- The player has a birthday and it has to be celebrated.\n- Landing and borrowing money, or actually the time when they should be returned by the bank or to the bank should be reminded by the assistant in the month the action happens.\n- Also, the assistant should remind on the amount of oil needed for house heating.\n\nWe've already reflected some of that data on the assistant's screen. Now we need to make sure that the assistant can handle the data and the logic behind it.\n\n## The Assistant Logic\n\nFirst off all let's extend the form with landing and borrowing money fields, which should be hidden by default.\n\n```html {numberLines: 452}\n<p id=\"you-get-money-back\" class=\"hidden\"></p>\n<p id=\"you-should-return-money\" class=\"hidden\"></p>\n```\n\nAlso we need to add the initial data which could be displayed on the assistant's screen.\n\n```javascript {numberLines: 25}\nconst assistantData = {\n  oilToHeatHouse: Math.random() * 29 + 1,\n  birthday: `${(Math.random() * 11 + 1).toFixed(0)}/${(\n    Math.random() * 27 +\n    1\n  ).toFixed(0)}`,\n  landSold: 0,\n  landBought: 0,\n  landGain: 0,\n  oilSold: 0,\n  oilBought: 0,\n  oilGain: 0,\n};\n```\n\nAnd display them on the screen.\n\n```javascript {numberLines: 197}\nconst setAssistantData = data => {\n  setElementData(\"oil-to-heat-house\", data.oilToHeatHouse.toFixed(0));\n  setElementData(\"birthday\", data.birthday);\n  setElementData(\"land-sold\", data.landSold);\n  setElementData(\"land-bought\", data.landBought);\n  setElementData(\"land-gain\", data.landGain);\n  setElementData(\"oil-sold\", data.oilSold);\n  setElementData(\"oil-bought\", data.oilBought);\n  setElementData(\"oil-gain\", data.oilGain);\n};\n```\n\nIn the `setAssets` function we need to add the logic to display the date when the money should be returned to the bank or when the money should be returned by the bank.\n\n```javascript {numberLines: 221}\nconst credit = gameData.bankData.credit[gameData.today.getMonth()];\nif (credit.amount !== 0) {\n  const element = setElementData(\n    \"you-should-return-money\",\n    `You should return money ${credit.returnDay} this month.`\n  );\n\n  if (gameData.today.getDate() < credit.returnDay) {\n    element.classList.remove(\"hidden\");\n  } else {\n    element.classList.add(\"hidden\");\n  }\n}\n\nconst deposit = gameData.bankData.deposit[gameData.today.getMonth()];\nif (deposit.amount !== 0) {\n  const element = setElementData(\n    \"you-get-money-back\",\n    `Bank will return money ${deposit.returnDay} of this month.`\n  );\n\n  if (gameData.today.getDate() < deposit.returnDay) {\n    element.classList.remove(\"hidden\");\n  } else {\n    element.classList.add(\"hidden\");\n  }\n}\n```\n\nDuring implementing this screen, I realized that I've made an error in the [Bank Logic](/articles/the-businessman-bank-logic). The data has been placed into the wrong cells in the array.\nI've fixed that by introducing the function which calculates the month when the money should be returned based on the current month and the time when the money should be returned.\nThis logic also counts with the year overflow.\n\n```javascript {numberLines: 475}\nconst getMonthToReturn = timeValue => {\n  const currentMonth = gameData.today.getMonth();\n  // Get current month + time to lend/borrow, if it is more than 11, then we need to return it next year\n  const monthToReturn =\n    currentMonth + timeValue > 11\n      ? currentMonth + timeValue - 12\n      : currentMonth + timeValue;\n\n  return monthToReturn;\n};\n```\n\nThat fix allowed me to remove `monthsToPayBack` from the `bankData` object, as the logic above is now handling that.\n\nAnd the last change which has been made is the logic for updating gains/losses and income balance. Here I'll show only one place how it has been done, but the logic is the same for all the other places,\nand the full version of the changes can be found on the [GitHub](https://github.com/smykhailov/the-businessman/releases/tag/v0.16).\nAlso you can use [comparison tool](https://github.com/smykhailov/the-businessman/compare/v0.15...v0.16) to see the changes between the previous version of the game.\n\n```javascript {numberLines: 762}\ngameData.accountBalances.netIncome -= totalLandPrice;\ngameData.assistantData.landBought += amountValue;\ngameData.assistantData.landGain -= totalLandPrice;\n```\n\n## Summary\n\nTha was the last UI screen we needed to implement. Now we have all the screens in place and we can start testing the game.\nSome of the logic will already work and display the correct data. The other addition will be related to the date changes logic, as when every new month starts, the taxes should be paid, and the new rates set.\n\nThat will be our next task. Wait for it.\n","frontmatter":{"title":"The Businessman - Assistant Logic","date":"2024-03-20T21:56:16.000Z","tags":["businessman","project","javascript"],"keywords":["business logic","javascript","the game","assistant logic","assistant"],"featuredImage":{"childImageSharp":{"gatsbyImageData":{"layout":"constrained","backgroundColor":"#0808f8","images":{"fallback":{"src":"/static/4d702984083eacd3cdd4dd7f485f7ee9/19534/cover.png","srcSet":"/static/4d702984083eacd3cdd4dd7f485f7ee9/82a03/cover.png 150w,\n/static/4d702984083eacd3cdd4dd7f485f7ee9/36e4e/cover.png 300w,\n/static/4d702984083eacd3cdd4dd7f485f7ee9/19534/cover.png 600w","sizes":"(min-width: 600px) 600px, 100vw"},"sources":[{"srcSet":"/static/4d702984083eacd3cdd4dd7f485f7ee9/6689f/cover.webp 150w,\n/static/4d702984083eacd3cdd4dd7f485f7ee9/bf45f/cover.webp 300w,\n/static/4d702984083eacd3cdd4dd7f485f7ee9/aaf0a/cover.webp 600w","type":"image/webp","sizes":"(min-width: 600px) 600px, 100vw"}]},"width":600,"height":334}}}},"internal":{"contentFilePath":"/home/runner/work/sergii-dev/sergii-dev/articles/2024-03-20-the-businessman-assistant-logic.mdx"},"fields":{"slug":"/articles/the-businessman-assistant-logic/","readingTime":{"text":"4 min read","minutes":3.425,"time":205500}}}},"pageContext":{"id":"b15f3f00-54d7-502e-a118-278814e16675","frontmatter":{"title":"The Businessman - Assistant Logic","date":"2024-03-20T21:56:16.000Z","published":true,"featuredImage":"./images/2024-03-20-the-businessman-assistant-logic/cover.png","categories":["Businessman"],"tags":["businessman","project","javascript"],"keywords":["business logic","javascript","the game","assistant logic","assistant"]}}},"staticQueryHashes":["1739528850","3446427935"],"slicesMap":{}}