{"componentChunkName":"component---src-components-article-tsx-content-file-path-home-runner-work-sergii-dev-sergii-dev-articles-2023-12-09-the-businessman-events-handling-mdx","path":"/articles/the-businessman-events-handling/","result":{"data":{"site":{"siteMetadata":{"title":"Sergii Mykhailov","author":"Sergii Mykhailov"}},"mdx":{"excerpt":"Overview In the previous blog post, we have learned about the basics of refctoring. In this blog post, we will learn about events handlingâ€¦","body":"\n## Overview\n\nIn the previous blog post, we have learned about [the basics of refctoring](/articles/the-businessman-basics-of-refactoring/).\nIn this blog post, we will learn about events handling in JavaScript, which is a way of reacting to various actions\nor changes that happen in a web page. Events can be triggered by user interactions, such as clicking a button,\nmoving the mouse, typing on the keyboard, or submitting a form. Events can also be triggered by the browser,\nsuch as loading a page, resizing the window, or closing a tab.\n\nTo handle events in JavaScript, we need two things: **an event target** and an **event handler**.\nAn event target is an HTML element that can emit or listen to events. For example, a button element can emit a\nclick event when it is clicked by the user. An event handler is a function that contains the code to execute\nwhen an event occurs. For example, an event handler can change the color of the button when it is clicked.\n\nEvent handling in JavaScript is a powerful feature that allows us to create dynamic and interactive web pages.\nBy using different methods and techniques, we can handle various types of events and customize our responses accordingly.\n\n## Assigning Event Handlers\n\nThere are different ways to assign event handlers to event targets in JavaScript.\n\nOne way is to use HTML attributes that start with \"on\", such as `onclick`, `onmouseover`, `onfocus`, etc.\nThese attributes take the name of a function or a code snippet as their value.\n\n```html\n<button onclick=\"alert('Hello')\">Click me</button>\n```\n\nThis code creates a button element that shows an alert message when it is clicked. The onclick attribute assigns\nthe alert function as the event handler for the click event.\n\nAnother way to assign event handlers is to use JavaScript properties that start with \"on\", such as `onclick`,\n`onmouseover`, `onfocus`, etc. These properties take a function reference or an anonymous function as their value.\n\n```javascript\nlet button = document.getElementById(\"myButton\");\n\nbutton.onclick = function () {\n  alert(\"Hello\");\n};\n```\n\nThis code selects a button element with the id \"myButton\" and assigns an anonymous function as the event handler\nfor the click event.\n\nA third way to assign event handlers is to use the `addEventListener` method of the event target.\nThis method takes three parameters: the name of the event (without the \"on\" prefix), the function reference\nor anonymous function as the event handler, and an optional boolean value that indicates whether to use\ncapturing or bubbling for the event propagation.\n\n```javascript\nlet button = document.getElementById(\"myButton\");\n\nbutton.addEventListener(\n  \"click\",\n  function () {\n    alert(\"Hello\");\n  },\n  false\n);\n```\n\nThis code does the same thing as the previous one, but uses the `addEventListener` method instead of the `onclick`\nproperty.\n\nThe advantage of using the `addEventListener` method is that it allows us to attach multiple event handlers\nfor the same event and remove them later with the `removeEventListener` method. It also gives us more control\nover how the event propagates through the DOM tree.\n\n## Some Common Events\n\n- `click`: occurs when the user clicks on an element\n- `mouseover`: occurs when the user moves the mouse over an element\n- `mouseout`: occurs when the user moves the mouse out of an element\n- `keydown`: occurs when the user presses a key on the keyboard\n- `keyup`: occurs when the user releases a key on the keyboard\n- `change`: occurs when the user changes the value of an input element\n- `submit`: occurs when the user submits a form\n- `load`: occurs when the browser finishes loading a page or an element\n- `resize`: occurs when the browser resizes the window\n- `unload`: occurs when the browser closes a tab or navigates away from a page\n\n## Add Event Handling to the Game\n\nNow that we have learned about events handling in JavaScript, let's add some event handlers to our game.\nFor this game we need only two types of events: `click` and `keydown`.\n\nThe `click` event is triggered when the user clicks with mouse or touch control on an element.\nThe `keydown` event is triggered when the user presses a key on the keyboard.\n\nWe can start with defining two functions which will register events.\n\n```javascript\n...\nsetMainMenuMouseActions();\nsetMainMenuKeyboardActions();\n...\n```\n\nWe don't have these functions yet, so let's create them. But before we start implementing them,\nwe need to add few windows to the HTML.\nWhen we created the [main screen](/articles/the-businessman-main-screen/) we added few helper CSS classes,\nwhich allows us to create windows by reusing that classes. That is one of the aspects of the Single Responsibility Principle (SRP) -\nability to reuse something which is well defined to do only one thing.\n\n```html {numberLines}\n<div class=\"modal hidden\">\n  <div class=\"window-wrapper primary-bg window-shadow text-color-black\">\n    <div class=\"window single-line-green\">\n      <div class=\"title\"></div>\n      <div class=\"window-content\"></div>\n    </div>\n  </div>\n</div>\n```\n\nAlsom, we need to add a CSS classes to handle modal window. We will use the `hidden` class to hide the window,\nans `modal` class to indicate which window is modal. Modal window should overlay all other windows.\n\n```css {numberLines}\n.hidden {\n  display: none;\n}\n\n.modal {\n  position: absolute;\n  top: 50px;\n  width: calc(660px - 20px);\n  height: calc(378px - 100px);\n  z-index: 100;\n  padding: 100px 0 0 20px;\n}\n```\n\nUsing the same pattern we will add windows for the bank, market, exchange, assets, assistant and quit,\nby adding `id` attributes and only titles for now, the content for each window we will add in the future posts.\n\n### Add Mouse Event Handlers\n\nAnd now we can move forward and implement the `setMainMenuMouseActions` function.\n\n```javascript {numberLines}\nconst setMainMenuMouseActions = () => {\n  const bankButton = document.getElementById(\"open-bank-btn\");\n  const marketButton = document.getElementById(\"open-market-btn\");\n  const exchangeButton = document.getElementById(\"open-exchange-btn\");\n  const assetsButton = document.getElementById(\"open-assets-btn\");\n  const assistantButton = document.getElementById(\"open-assistant-btn\");\n  const quitButton = document.getElementById(\"open-quit-btn\");\n\n  bankButton.addEventListener(\"click\", () => {\n    open(\"bank-main\");\n  });\n\n  marketButton.addEventListener(\"click\", () => {\n    open(\"market-main\");\n  });\n\n  exchangeButton.addEventListener(\"click\", () => {\n    open(\"exchange-main\");\n  });\n\n  assetsButton.addEventListener(\"click\", () => {\n    open(\"assets-main\");\n  });\n\n  assistantButton.addEventListener(\"click\", () => {\n    open(\"assistant-main\");\n  });\n\n  quitButton.addEventListener(\"click\", () => {\n    open(\"quit-main\");\n  });\n\n  closeWindowMouseHandler();\n};\n```\n\nThis function will register `click` event for each button in the main menu.\nWhen user clicks on the button, it will open the corresponding window. Also, we see that there are few additional\nfunctions called `open` and `closeWindowMouseHandler`.\n\nThe `open` function is very simple, it gets the window by its `id` and removes the `hidden` class from the window.\n\n```javascript {numberLines}\nconst open = windowId => {\n  const window = document.getElementById(windowId);\n  window.classList.remove(\"hidden\");\n};\n```\n\nThe `closeWindowMouseHandler` function is a bit more complicated. It will register `click` event for each window.\nWhen user clicks on the window, it will close it. But we don't want to close the window when user clicks on the internal window.\n\n```javascript {numberLines}\nconst closeWindowMouseHandler = () => {\n  const windows = document.getElementsByClassName(\"modal\");\n  for (let i = 0; i < windows.length; i++) {\n    const window = windows[i];\n\n    window.addEventListener(\"click\", e => {\n      // Apply clicks only to the modal window itself\n      if (e.target !== window) {\n        return;\n      }\n\n      window.classList.add(\"hidden\");\n    });\n  }\n};\n```\n\nNow we can test our game and see that we can open and close windows by clicking on the buttons and on the windows.\n\n### Add Keyboard Event Handlers\n\nThe keyboard event handlers requires the element to assign the event to and handler function.\nWe will use the `document` as the element, because we want to handle the keyboard events on the whole page.\n\n```javascript {numberLines}\nconst setMainMenuKeyboardActions = () => {\n  // Assign key bindings to open windows\n  // By assigning it to the document, we can open windows from any page\n  // and make sure there is only one handler for all windows\n  document.addEventListener(\"keydown\", e => {\n    assignKeyBindingsToOpenWindow(\"b\", \"bank-main\", e);\n    assignKeyBindingsToOpenWindow(\"m\", \"market-main\", e);\n    assignKeyBindingsToOpenWindow(\"e\", \"exchange-main\", e);\n    assignKeyBindingsToOpenWindow(\"a\", \"assets-main\", e);\n    assignKeyBindingsToOpenWindow(\"s\", \"assistant-main\", e);\n    assignKeyBindingsToOpenWindow(\"q\", \"quit-main\", e);\n\n    closeWindowKeyboardHandler(e);\n  });\n};\n```\n\nNow we can implement the `assignKeyBindingsToOpenWindow` function. We have to make sure,\nthat we don't open the window if there is already opened one. Here we can reuse the `open` function again.\n\n```javascript {numberLines}\nconst assignKeyBindingsToOpenWindow = (keyBinding, windowId, e) => {\n  // Do not allow to open window, if there is already opened window\n  const isThereOpenedWindow = document.querySelector(\".modal:not(.hidden)\");\n  if (isThereOpenedWindow) {\n    return;\n  }\n\n  if (\n    e.key === keyBinding ||\n    (e.key === keyBinding.toUpperCase() && e.shiftKey)\n  ) {\n    open(windowId);\n  }\n};\n```\n\nAnd the last function to implement is the `closeWindowKeyboardHandler`. This function will close the window\nwhen user presses the `Escape` key.\n\n```javascript {numberLines}\nconst closeWindowKeyboardHandler = e => {\n  if (e.key === \"Escape\") {\n    // Do not allow to open window, if there is already opened window\n    const openedWindow = document.querySelector(\".modal:not(.hidden)\");\n\n    if (openedWindow) {\n      openedWindow.classList.add(\"hidden\");\n    } else {\n      open(\"quit-main\");\n    }\n  }\n};\n```\n\nAnd that's it, not so complicated, right?\n\n## Summary\n\nIn this blog post, we have learned about events handling in JavaScript. We have learned how to assign event handlers.\nAlso we added more interactivity to our game. Now we can open and close windows by clicking on the buttons and on the windows.\nAlso we can open windows by pressing the keyboard keys.\n\nAs always, the full source code for this blog post is available [in the GitHub repository](https://github.com/smykhailov/the-businessman/releases/tag/v0.5).\n\nIn the next blog post, we will create the bank window and add some functionality to it.\n","frontmatter":{"title":"The Businessman - Events Handling","date":"2023-12-09T19:33:43.000Z","tags":["businessman","project","javascript"],"keywords":["events handling","javascript","the game"],"featuredImage":{"childImageSharp":{"gatsbyImageData":{"layout":"constrained","backgroundColor":"#080808","images":{"fallback":{"src":"/static/d90793385e2195172df1745a97311041/4cb25/cover.jpg","srcSet":"/static/d90793385e2195172df1745a97311041/fee89/cover.jpg 150w,\n/static/d90793385e2195172df1745a97311041/a0d9b/cover.jpg 300w,\n/static/d90793385e2195172df1745a97311041/4cb25/cover.jpg 600w","sizes":"(min-width: 600px) 600px, 100vw"},"sources":[{"srcSet":"/static/d90793385e2195172df1745a97311041/f5103/cover.webp 150w,\n/static/d90793385e2195172df1745a97311041/dc425/cover.webp 300w,\n/static/d90793385e2195172df1745a97311041/381e5/cover.webp 600w","type":"image/webp","sizes":"(min-width: 600px) 600px, 100vw"}]},"width":600,"height":338}}}},"internal":{"contentFilePath":"/home/runner/work/sergii-dev/sergii-dev/articles/2023-12-09-the-businessman-events-handling.mdx"},"fields":{"slug":"/articles/the-businessman-events-handling/","readingTime":{"text":"8 min read","minutes":7.625,"time":457500}}}},"pageContext":{"id":"0d039db6-4c44-5313-977d-091639539fd3","frontmatter":{"title":"The Businessman - Events Handling","date":"2023-12-09T19:33:43.000Z","published":true,"featuredImage":"./images/2023-12-09-the-businessman-events-handling/cover.jpg","categories":["Businessman"],"tags":["businessman","project","javascript"],"keywords":["events handling","javascript","the game"]}}},"staticQueryHashes":["1739528850","3446427935"],"slicesMap":{}}